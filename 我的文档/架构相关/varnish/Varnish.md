# Varnish 简介

Varnish 是一款高性能的开源**反向代理服务器**和 **HTTP 缓存加速服务器**。它主要用于加速 Web 应用程序的性能，通过缓存静态或缓慢变化的内容，减轻后端服务器的负担，从而提高 Web 应用程序的性能和吞吐量。现实中更多用作搭建 CDN 服务器。

官网 https://varnish-cache.org/

https://blog.csdn.net/weixin_47019016/article/details/107707871

技术选型

https://www.cnblogs.com/kevingrace/p/6188123.html

当然其反向代理能力不如 nginx，nginx 的缓存管理能力不如 Varnish，在架构方案中，使用此两者取长补短。Varnish 主要用于缓存静态内容，提高 Web 服务器的响应速度。它专注于减少后端服务器的负载，通过缓存响应内容来加速请求处理。

**主要特点**

- **高性能**：Varnish 被设计成高性能的反向代理缓存服务器，能够处理数千个并发连接。
- **可扩展性**：支持多个缓存服务器集群化，可以通过增加缓存服务器来扩展性能和容量。
- **灵活性**：支持高度自定义的配置选项和 VCL（Varnish Configuration Language）语言扩展，使得可以根据特定的应用程序需求进行调整和优化。
- **可靠性**：提供了多种故障处理和恢复机制，包括健康检查、动态后端服务器池和热备份等。

**工作原理**

Varnish 的工作原理是通过在前端和后端之间建立一个缓存层，将经过代理服务器的请求缓存下来。当同样的请求再次到达服务器时，就直接从缓存中取出数据返回给客户端，而无需再次访问源服务器。

**对比 Squid**

与传统的 Squid 相比，Varnish 具有以下优势：

- **更高的稳定性**：Varnish 的稳定性更高，Squid 服务器发生故障的几率要高于 Varnish。
- **更快的访问速度**：Varnish 采用“Visual Page Cache”技术，所有缓存数据都直接从内存读取，而 Squid 是从硬盘读取，因而 Varnish 在访问速度方面会更快。
- **更多的并发连接**：Varnish 可以支持更多的并发连接，因为 Varnish 的 TCP 连接释放要比 Squid 快。
- **批量清除缓存**：Varnish 可以通过管理端口，使用正则表达式批量的清除部分缓存，而 Squid 是做不到的。

**适用场景**

Varnish 适用于需要高性能和高并发处理的 Web 应用场景，如大型门户网站、电子商务平台、内容管理系统等。它可以作为 CDN 缓存服务器的可选服务之一，帮助企业提高网站的响应速度和用户体验。



