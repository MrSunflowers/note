# 集群方式

## 读写分离集群方式

主体结构：由主节点 master 与子节点 node 组成，子节点利用 MySQL 自带的主从同步机制，即binlog 日志同步。其中写入操作只在主节点进行，并同步给子节点，读取操作可在任一节点进行，这是 MySQL 自带的简单集群模式。

在应用中增加一层中间件，可以是 MyCat 或其他数据库分片中间件，主要作用是根据提交的 SQL 行为，如 insert，update，delete 语句将路由至主节点执行，select 查询则路由至从节点执行。

故障转移：利用 MHA 中间件实现，在主节点挂掉之后自动选举提升从节点为主节点。

适用于互联网等读多写少的场景。

## 数据分片集群模式

在数据量越来越大，单表数据常常过千万级别时，可采用数据分片集群模式，即分库分表。

分片中间件实现 SQL 路由，如 MyCat。

适用于十亿至几十亿数据量的数据存储，当数据超出几十亿的时候，就需要考虑采用非关系型数据库来处理。

分片算法：

基于范围的分片，如时间范围，优点是集群扩展简单，缺点是易造成流量倾斜
基于Hash算法分片，主要有Hash取模和一致性Hash算法，优点是数据分布均匀，缺点是集群难以扩展




































