# 一、XSS（跨站脚本攻击）

1. 什么是 XSS 攻击？

**跨站脚本攻击（Cross-Site Scripting，简称 XSS）** 是一种常见的安全漏洞，攻击者通过向 Web 页面中注入恶意脚本代码，使其他用户在访问该页面时执行这些代码。XSS 攻击通常用于窃取用户的敏感信息，如 Cookie、会话令牌等。

2. XSS 攻击的类型

1. **存储型 XSS（Stored XSS）**：
   - 攻击者将恶意脚本代码存储在目标服务器上，例如数据库、留言等。
   - 当用户访问包含恶意脚本的页面时，浏览器会执行该脚本。
   - 例如，在博客评论中注入恶意脚本，所有查看该评论的用户都会受到影响。

2. **反射型 XSS（Reflected XSS）**：
   - 攻击者通过构造包含恶意脚本的 URL，诱导用户点击。
   - 服务器将恶意脚本反射回用户的浏览器并执行。
   - 例如，攻击者在搜索框中注入恶意脚本，用户搜索后，服务器将恶意脚本返回给用户浏览器。

3. **DOM 型 XSS（DOM-based XSS）**：
   - 攻击者通过修改页面的 DOM 环境，注入恶意脚本。
   - 例如，通过修改 URL 参数，攻击者可以控制页面的某些元素，从而执行恶意脚本。

3. XSS 攻击的危害

- **窃取用户信息**：攻击者可以窃取用户的 Cookie、会话令牌等敏感信息，从而劫持用户会话。
- **钓鱼攻击**：攻击者可以通过恶意脚本伪造登录页面，诱骗用户输入敏感信息。
- **篡改页面内容**：攻击者可以修改页面内容，插入虚假信息或广告。
- **执行恶意操作**：攻击者可以在用户浏览器中执行任意操作，如发送请求、下载恶意软件等。

4. XSS 攻击的防护措施

1. **输入验证**：
   - 对用户输入进行严格的验证和过滤，确保输入的数据符合预期格式。
   - 例如，使用正则表达式验证输入数据的长度、类型等。

2. **输出编码**：
   - 对输出到页面的数据进行编码，防止恶意脚本注入。
   - 例如，使用 HTML 实体编码（如 `&amp;` 代替 `&`）来转义特殊字符。

3. **使用内容安全策略（CSP）**：
   - 配置 CSP 头部，限制页面中可以执行的脚本来源。
   - 例如，限制脚本只能从特定的域名加载，禁止内联脚本。

4. **设置 HttpOnly 和 Secure 标志**：
   - 设置 Cookie 的 HttpOnly 标志，防止 JavaScript 访问 Cookie。
   - 设置 Cookie 的 Secure 标志，确保 Cookie 只能通过 HTTPS 传输。

5. **使用现代 Web 框架**：
   - 使用现代 Web 框架，这些框架通常内置了 XSS 防护机制。
   - 例如，使用 React、Angular 等框架，这些框架会自动对输出数据进行编码。

# 二、表单伪造（CSRF）

1. 什么是表单伪造？

**表单伪造（Cross-Site Request Forgery，简称 CSRF）** 是一种攻击，攻击者通过构造恶意请求，诱导用户在已登录的 Web 应用程序中执行未授权的操作。表单伪造通常利用用户的身份信息（如 Cookie、会话令牌）来执行恶意操作。

2. 表单伪造的攻击方式

1. **诱导用户点击恶意链接**：
   - 攻击者构造一个包含恶意请求的链接，诱导用户点击。
   - 例如，攻击者构造一个删除用户账户的链接，用户点击后，浏览器会发送删除请求。

2. **构造恶意表单**：
   - 攻击者在恶意网站中构造一个包含恶意请求的表单，诱导用户提交。
   - 例如，攻击者在恶意网站中构造一个隐藏的表单，用户访问该网站时，浏览器会自动提交表单。

3. **利用 XSS 漏洞**：
   - 攻击者利用 XSS 漏洞，在目标网站中注入恶意脚本，构造恶意请求。

3. 表单伪造的危害

- **执行未授权操作**：攻击者可以执行用户未授权的操作，如修改密码、转账、删除账户等。
- **数据泄露**：攻击者可以通过表单伪造窃取用户的敏感信息。
- **系统破坏**：攻击者可以破坏系统的数据完整性，导致系统崩溃。

4. 表单伪造的防护措施

1. **使用 CSRF Token**：
   - 在每个表单中生成一个唯一的 CSRF Token，服务器验证 Token 的有效性。
   - 例如，在表单中添加一个隐藏的 CSRF Token 字段，服务器验证 Token 是否正确。

2. **使用 SameSite Cookie 属性**：
   - 设置 Cookie 的 SameSite 属性，限制 Cookie 的跨站请求。
   - 例如，设置 SameSite=Strict，禁止跨站请求携带 Cookie。

3. **双重验证**：
   - 在执行敏感操作时，要求用户进行双重验证，如输入密码、验证码等。

4. **验证 Referer 和 Origin 头部**：
   - 服务器验证请求的 Referer 或 Origin 头部，确保请求来自可信的来源。
   - 例如，验证请求是否来自同一个域名。

5. **使用现代 Web 框架**：
   - 使用现代 Web 框架，这些框架通常内置了 CSRF 防护机制。
   - 例如，使用 Django、Ruby on Rails 等框架，这些框架会自动生成和管理 CSRF Token。
  
6. **提交重要数据前添加验证码**
   - 使用服务器生成的验证码，即使表单被伪造，也无法识别由后台服务器生成的验证码信息，无法伪造数据进行提交


